if(apex.worksheet===null||typeof apex.worksheet!="object")apex.worksheet={};apex.worksheet={ws:function(a){function c(a){this.l_Action=!1,this.l_Type=!1,b.ajax_busy=!1,!a||(b.worksheet_id=a),b.report_id=$v("apexir_REPORT_ID")?$v("apexir_REPORT_ID"):"0",$x("apexir_REGION_ID")&&apex.jQuery("#"+$v("apexir_REGION_ID")).bind("apexrefresh",function(){b.search()}),this.get=new htmldb_Get(null,$v("pFlowId"),"APXWGT",$v("pFlowStepId"))}var b=this;this.ajax_busy=!1,this.worksheet_id=!1,this.report_id=!1,this.current_col_id=!1,this.last_col_id=!1,this.current_control=!1,this.active_dialog=!1,this.supress_update=!1,this.external_items=!1,this.init=c,this.init(a),this.toggle_controls=function(){var a=$x("apexir_CONTROL_PANEL_COMPLETE").style.display!="none"?"Y":"N";$x_ToggleWithImage("apexir_CONTROLS_IMAGE",["apexir_CONTROL_PANEL_COMPLETE","apexir_CONTROL_PANEL_SUMMARY"]),b.supress_update=!0,b.action("CONTROL_MIN",!1,!1,a)},this.item={},this.item.worksheet_holder=function(){return $x("apexir_WORKSHEET_REGION")},this.item.worksheet_detail=function(){return $x("apexir_DETAIL")},this.item.worksheet_report=function(){return $x("apexir_REPORT")},this.item.worksheet_div=function(){return $x("apexir_WORKSHEET")},this.item.control_panel_drop=function(){return $x("apexir_CONTROL_PANEL_DROP")},this.item.ws_control_panel=function(){return $x("apexir_CONTROL_PANEL")},this.item.worksheet_id=function(){return $x("apexir_NUM_ROWS")},this.item.search=function(){return $x("apexir_SEARCH")},this.item.search_column=function(){return $x("apexir_CURRENT_SEARCH_COLUMN")},this.dialog={},this.dialog.check=function(a){var c=html_GetTarget(a),d=$x("apexir_rollover"),e=!0;while(c.nodeName!="BODY")c=c.parentNode,c==d&&(e=!1);e&&b.dialog.reset()},this.dialog.check2=function(a){var b=html_GetTarget(a),c=$x("apexir_col_values_drop");if(c){var d=!0;while(b.nodeName!="BODY")b=b.parentNode,b==c&&(d=!1);d&&$x_Remove("apexir_col_values_drop")}},this.dialog.colorPicker=function(a,b){apex.jQuery(a).each(function(){var a=apex.jQuery(this).ColorPicker({eventName:"xxx",onSubmit:function(a,b,c,d){$s(d,"#"+b.toUpperCase()),apex.jQuery(d).ColorPickerHide()},onBeforeShow:function(){apex.jQuery(this).ColorPickerSetColor(this.value)},onShow:function(a){return apex.jQuery(a).fadeIn("fast"),!1},onHide:function(a){return apex.jQuery(a).fadeOut("fast"),!1}}).ColorPickerHide();a.bind("keyup",function(){a.ColorPickerSetColor(this.value)}).bind("blur",function(){a.ColorPickerHide()}).bind("change",function(){this.value=this.value.toUpperCase(),apex.jQuery("#"+this.id+"_PREVIEW").css("background",this.value)}),apex.jQuery("#"+this.id+"_PICKER").click(function(b){a.ColorPickerShow(),b.preventDefault()}),apex.jQuery("#"+this.id+"_PREVIEW").css("background",this.value)})},this.dialog.reset=function(){b.supress_update||($d_ClearAndHide(["searchdrop",b.item.control_panel_drop(),"apexir_SEARCHDROP"]),$x_Hide(["searchdrop","apexir_rollover"]),$s("apexir_rollover_content",""),$x(b.last_col_id)&&$x_Class($x(b.last_col_id).parentNode,""),b.dialog.id=!1,document.body.onclick="",apex.jQuery(document).unbind("keydown.menu_keys_colsearch"))},this.dialog.util_exp_type=function(){var a={};return a.col=$x("apexir_COLUMN_NAME"),a.col_type=a.col.options[a.col.selectedIndex].className,a.col_opt=$x("apexir_"+a.col_type+"_OPT"),a.col_opt_val=$v(a.col_opt),a.col_type=="DATE"&&a.col_opt_val!="is in the last"&&a.col_opt_val!="is not in the last"&&a.col_opt_val!="is in the next"&&a.col_opt_val!="is not in the next"?a.form_items=["apexir_BETWEEN_FROM","apexir_BETWEEN_TO"]:a.form_items=["apexir_EXPR","apexir_EXPR2"],a},this.dialog.validate=function(a){var c=[],d=b.dialog.util_exp_type();switch(!0){case d.col_opt_val=="between":c=[d.form_items[0],d.form_items[1]];break;case d.col_opt_val=="is null"||d.col_opt_val=="is not null":c=[];break;case d.col_opt_val=="is in the last"||d.col_opt_val=="is not in the last"||d.col_opt_val=="is in the next"||d.col_opt_val=="is not in the next":c=[d.form_items[0],"apexir_EXPR3"];break;default:c=[d.form_items[0]]}return $f_get_emptys(c,"error","")?!1:d},this.dialog.operator_check=function(a){var b=$x("apexir_COLUMN_NAME").options[$x("apexir_COLUMN_NAME").selectedIndex].className,c=$v(a),d=[];d[0]=$x("apexir_EXPR").parentNode,d[1]=$x("apexir_EXPR2").parentNode,d[2]=$x("apexir_EXPR3").parentNode,d[3]=$x("apexir_BETWEEN_FROM").parentNode,d[4]=$x("apexir_BETWEEN_TO").parentNode,$x_Show_Hide("apexir_EXPR_ICON",d);if(c==="is null"||c==="is not null"){$x_Hide("apexir_EXPRESSION_LABEL");return}$x_Show("apexir_EXPRESSION_LABEL"),b==="DATE"&&c!=="is in the last"&&c!=="is not in the last"&&c!=="is in the next"&&c!=="is not in the next"?($x_Show(d[3]),c==="between"?$x_Show(d[4]):null):($x_Show(d[0]),c==="between"?$x_Show(d[1]):null,c==="is in the last"||c==="is not in the last"||c==="is in the next"||c==="is not in the next"?$x_Show_Hide(d[2],"apexir_EXPR_ICON"):null);return},this.dialog.column_check=function(a){var c=a.options[a.selectedIndex].className;$x_HideSiblings("apexir_"+c+"_OPT"),b.dialog.operator_check("apexir_"+c+"_OPT")},this.dialog.comp=function(a,b){lSpace=!isNaN(b)||b===".",html_ReturnToTextSelection(b,a,lSpace)},this.controls={},this.controls.cancel=function(){b.dialog.reset()},this.controls.save_toggle=function(a){var b=$v(a)=="NAMED"?"apexir_SAVE_NAMED":"apexir_SAVE_DEFAULT";$x_HideSiblings(b)},this.controls.drop=function(){return b.item.control_panel_drop()},this.controls.get=function(a,c){b.dialog.reset(),b.l_Action="CONTROL",b.l_Type=a,b.current_control=a,b.current_dom=$x(c),c&&(b.current_col_id=c),b._Get("CONTROL",a,!1,c)},this.controls.menu=function(a,c){b.dialog.reset(),app_AppMenuMultiOpenBottom2(a,c,!1)},this.controls.widget=function(a){this.get("SORT_WIDGET",a),b.current_col_dom=$x(a),document.body.onclick=b.dialog.check},this.controls.narrow=function(a){b.supress_update=!0,b.temp_return_element=$x(a),this.get("NARROW",$v("apexir_COLUMN_NAME"))},this.controls.format_mask=function(a){b.supress_update=!0,b.temp_return_element=$x(a),this.get("FORMAT_MASK_LOV")},this.controls.col_lov=function(a){this.get("COL_LOV",a)},this.controls.radio_lov=function(a){this.get("RADIO_LOV",a)},this.controls.filter2=function(){b.controls.set=!0,this.get("SHOW_FILTER")},this.group_by={},this.group_by.view=function(){b.action("VIEW_GROUP_BY",!1,!1)},this.group_by.save=function(){b.supress_update=!0,b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action("GROUP_BY_SAVE")},this.group_by.remove=function(){b.action("GROUP_BY_REMOVE")},this.group_by.control=function(a){var b,c,d;a&&(b=a.id,c=["SUM","AVG","MAX","MIN","MEDIAN","RATIO_TO_REPORT_SUM"],d=b.substr(b.length-2),apex.jQuery.inArray($v(a),c)!==-1?$x_Show_Hide("NUMBER_COLUMNS_"+d,"ALL_COLUMNS_"+d):$x_Show_Hide("ALL_COLUMNS_"+d,"NUMBER_COLUMNS_"+d))},this.controls.row=function(a){this.get("SHOW_DETAIL",a)},this.controls.computation=function(a){a=a?a:b.dialog.id,this.get("SHOW_COMPUTATION",a),b.dialog.id=!1},this.controls.info=function(a){this.get("INFO",b.current_col_id)},this.highlight={},this.highlight.clear=function(a){b.action("CLEAR_HIGHLIGHT",!1,$nvl(a,$x("HIGHLIGHT_ID").value))},this.highlight.toggle=function(a,c){b.action("TOGGLE_HIGHLIGHT",!1,c,a.checked?"Y":"N")},this.highlight.save=function(a){var c=b.dialog.validate();if(!c)return;b.supress_update=!0,b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action("SAVE_HIGHLIGHT"),c=null;return},this.navigate={},this.navigate.paginate=function(a){b.get.addParam("p_widget_num_return",a.split("max_rows=")[1].split("rows_fetched")[0]),b.action("PAGE",a)},this.column={},this.column.pOb=this,this.column.break_on=function(a){a&&(b.current_col_id=a),b.action("BREAK",!1,b.current_col_id)},this.column.break_toggle=function(a,c){b.action("BREAK_TOGGLE",!1,c,a.checked?"Y":"N")},this.column.hide=function(a){var c=a?a:b.current_col_id;b.action("HIDE",!1,c)},this.column.filter=function(a){var c="ADD";a?(b.current_col_id=a,c="UPDATE"):a=$v("apexir_COLUMN_NAME");if($v("apexir_FILTER_TYPE")=="COLUMN"){var d=b.dialog.validate();if(!d)return;var e=["apexir_FILTER_TYPE",d.col,d.col_opt,d.form_items[0],d.form_items[1],"apexir_EXPR3"]}else var e=["apexir_FILTER_TYPE","apexir_FILTER_EXPR","apexir_FILTER_NAME"];b.get.AddArrayItems(e,1),b.supress_update=!0,b.action("FILTER",c,a)},this.column.filter_delete=function(a){b.action("FILTER_DELETE",!1,a)},this.column.filter_toggle=function(a,c){b.action("FILTER_TOGGLE",!1,c,a.checked?"Y":"N")},this.column.filter_control=function(a){$v("apexir_FILTER_TYPE")=="COLUMN"?($x_Show("apexir_COLUMN_FILTER"),$x_Hide("apexir_ROW_FILTER")):($x_Show("apexir_ROW_FILTER"),$x_Hide("apexir_COLUMN_FILTER"))},this.column.display=function(a){var c=[],d=$x("apexir_shuttle2").getElementsByTagName("SELECT")[0];for(i=0,len=d.options.length;i<len;i++)c[c.length]=d.options[i].value;b.get.AddArray(c,1),b.action("SET_COLUMNS")},this.column.order=function(a){a=="ASC"||a=="DESC"?(b.get.addParam("f01",b.last_col_id),b.get.addParam("f02",a),b.action("COLUMN_ORDER")):(b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action("SORT"))},this.group_by.sort=function(a){a=="ASC"||a=="DESC"?(b.last_col_id=a.id,b.get.addParam("f01",b.last_col_id),b.get.addParam("f02",a),b.action("GROUP_BY_COLUMN_SORT",!1,$v("apexir_GROUP_BY_ID"))):(b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action("GROUP_BY_SORT",!1,$v("apexir_GROUP_BY_ID")))},this.column.break_save=function(a){a=="ENABLE"||a=="DISABLE"?(b.get.AddNameValue("apexir_COLUMN_01",b.last_col_id,1),b.get.AddNameValue("apexir_ENABLE_01",a,2)):b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action("SAVE_BREAK")},this.flashback={},this.flashback.save=function(){b.supress_update=!0,b.action("FLASHBACK_SET",!1,!1,$v("apexir_FLASHBACK_TIME"))},this.flashback.clear=function(){b.action("FLASHBACK_CLEAR",!1,!1,!1)},this.flashback.toggle=function(){b.action("FLASHBACK_TOGGLE",!1,!1,!1)},this.aggregate={},this.aggregate.control=function(){var a,b;a=$v("apexir_AGGREGATE_BY"),b=["COUNT","COUNT_DISTINCT"],apex.jQuery.inArray(a,b)!==-1?$x_Show_Hide("ALL_COLUMNS","NUMBER_COLUMNS"):$x_Show_Hide("NUMBER_COLUMNS","ALL_COLUMNS")},this.aggregate.save=function(){var a,c,d,e;a=$v("apexir_AGGREGATE_BY"),c=$v("apexir_AGGREGATION"),d=["COUNT","COUNT_DISTINCT"],e=apex.jQuery.inArray(a,d)!==-1?$v("apexir_COLUMN_NAME_ALL"):$v("apexir_COLUMN_NAME"),b.action("SAVE_AGGREGATE",!1,c,a,e)},this.aggregate.clear=function(){b.action("DELETE_AGGREGATE",!1,$v("apexir_AGGREGATION"))},this.aggregate.toggle=function(){},this.computation={},this.computation.save=function(){var a=$f_get_emptys(["apexir_COLUMN_LABEL","apexir_COMPUTATION_EXPR"],"error","");if(!!a)return;b.supress_update=!0,b.action("SAVE_COMPUTATION",!1,$v("apexir_COMPUTATION_ID"),$v("apexir_COLUMN_LABEL"),$v("apexir_REPORT_LABEL"),$v("apexir_FORMAT_MASK"),$v("apexir_COMPUTATION_EXPR"))},this.computation.clear=function(){b.action("DELETE_COMPUTATION",!1,$v("apexir_COMPUTATION_ID"))},this.computation.toggle=function(){},this.chart={},this.chart.control=function(a){var b=[];b[0]=$x("apexir_LABEL_AXIS_TITLE").parentNode,b[1]=$x("apexir_VALUE_AXIS_TITLE").parentNode,b[2]=b[0].previousSibling,b[3]=b[1].previousSibling,$x("apexir_CHART_TYPE_2").checked?$x_Hide(b):$x_Show(b)},this.chart.save=function(){b.supress_update=!0;var a=["apexir_CHART_TYPE","apexir_CHART_LABEL","apexir_CHART_VALUE","apexir_AGGREGATE_BY","apexir_LABEL_AXIS_TITLE","apexir_VALUE_AXIS_TITLE","apexir_SORT"];b.get.AddArrayItems(a,1),b.action("SAVE_CHART")},this.chart.clear=function(){b.action("DELETE_CHART")},this.chart.view=function(){b.action("VIEW_CHART",!1,!1)},this.email={},this.email.send=function(){var a=$f_get_emptys("apexir_EMAIL_TO","error","");if(!!a)return;var c=["apexir_EMAIL_TO","apexir_EMAIL_CC","apexir_EMAIL_BCC","apexir_EMAIL_SUBJECT","apexir_EMAIL_BODY"];b.get.AddArrayItems(c,1),b.action("SEND_EMAIL")},this.email.show=function(a){$x_Show_Hide(["apexir_EMAIL","apexir_EMAIL_BUTTON"],"apexir_DOWNLOAD_BUTTON")},this.calendar={},this.calendar.save=function(){b.action("SAVE_CALENDAR",!1,!1,$v("DATE_COLUMN"),$v("DISPLAY_COLUMN"))},this.calendar.view=function(){b.action("VIEW_CALENDAR",!1,!1)},this.data={},this.data.view=function(a){a&&b.get.addParam("p_widget_view_mode",a),b.action("VIEW_REPORT",!1,!1)},this.detail={},this.detail.last_row_opened=!1,this.detail.show=function(a){if(b.ajax_busy)return;apex.jQuery(".displayed, .other").show(),$x("apexir_EXCLUDE_NULL_0").checked&&$x("apexir_DISPLAY_OPTION").checked?apex.jQuery(".null, .other").hide():$x("apexir_EXCLUDE_NULL_0").checked?apex.jQuery(".null").hide():$x("apexir_DISPLAY_OPTION").checked&&apex.jQuery(".other").hide(),b.l_Action="CHANGE_DETAIL_OPTION",b.supress_update=!0,b.action("CHANGE_DETAIL_OPTION",!1,!1,$v("apexir_EXCLUDE_NULL_0"),$v("apexir_DISPLAY_OPTION"))},this.remove=function(a){var c;c=$nvl(a,"DELETE"),b.action(c,!1,!1,!1)},this.reset=function(){b.action("RESET",!1,!1,!1)},this.save=function(a){var c=$x("create_category"),d=$f_get_emptys(["apexir_WORKSHEET_NAME"],"error","");c&&(d=$f_get_emptys([c],"error",""));if(!!d)return;l_cat=c?c.value:$v("apexir_WORKSHEET_CATEGORY"),a=a?"RENAME":"SAVE",b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action(a,!1,!1)},this.get_saved_rpt_xml=function(){var a=$x("apexir_SAVED_REPORTS"),c=new htmldb_Get(null,$v("pFlowId"),"INTERNAL_APPLICATION_PROCESS=ir_reports_select_xml2",$v("pFlowStepId"));c.addParam("x01",$v("apexir_WORKSHEET_ID")),c.addParam("x02",b.report_id),gReturn=c.get("XML");if(gReturn&&a){var d=gReturn.getElementsByTagName("option").length;a.length=0;for(var e=0;e<d;e++){var f=gReturn.getElementsByTagName("option")[e];b.appendToSelect(a,f.getAttribute("value"),f.firstChild.nodeValue)}}c=null},this.appendToSelect=function(a,b,c){var d=document.createElement("option");d.value=b,document.all?(a.options.add(d),d.innerText=c):(d.appendChild(document.createTextNode(c)),a.appendChild(d))},this.save_default=function(a){var c,d;$v("apexir_DEFAULT_TYPE")==="ALTERNATIVE"&&(d=$f_get_emptys(["apexir_WORKSHEET_NAME"],"error","")),d||(c=$nvl(a,"SAVE_DEFAULT"),b.get.AddArrayItems2($x_FormItems("apexir_CONTROL_PANEL_DROP"),1),b.action(c,!1,!1,!1))},this.save_default_type_check=function(){$v("apexir_DEFAULT_TYPE")==="PRIMARY"?$x_ItemRow("apexir_WORKSHEET_NAME","HIDE"):$x_ItemRow("apexir_WORKSHEET_NAME","SHOW")},this.save_category_check=function(a){a.value=="new"?$dom_AddInput(a.parentNode,"text","create_category",""):$x_Remove("create_category")},this.pull=function(a,c){!a||(b.report_id=a),b._Get("PULL",c)},this.download=function(a){},this.key={},this.key.$gAnchorList,this.key.navigate={},this.key.navigate.up=function(a){var c,d;c=apex.jQuery(a.target),d=b.key.$gAnchorList.index(c),b.key.$gAnchorList.eq(d-1).focus(),a.preventDefault()},this.key.navigate.down=function(a){var c,d;c=apex.jQuery(a.target),d=b.key.$gAnchorList.index(c),b.key.$gAnchorList.eq(d+1).focus(),a.preventDefault()},this.key.navigate.esc=function(a,c,d){b.dialog.reset(),apex.jQuery(document).unbind("keydown."+d+""),c.focus(),a.preventDefault()},this.key.navigate.enter=function(a){apex.jQuery(document).unbind("keydown."+a+"")},this.key.action=function(a,c,d){switch(a.which){case 40:b.key.navigate.down(a);break;case 38:b.key.navigate.up(a);break;case 27:b.key.navigate.esc(a,c,d);break;case 13:b.key.navigate.enter(d);break;default:null}},this.notify={},this.notify.save=function(){b.supress_update=!0;var a=["apexir_NOTIFY_ID","apexir_EMAIL_ADDRESS","apexir_EMAIL_SUBJECT","apexir_NOTIFY_INTERVAL","apexir_START_DATE","apexir_START_HH","apexir_START_AM_PM","apexir_END_DAY","apexir_END_DAY_UNIT"];b.get.AddArrayItems2(a,1),b.action("SAVE_NOTIFY")},this.notify.clear=function(){b.action("DELETE_NOTIFY",!1,$v("apexir_NOTIFY_ID"))},this.search=function(a,c){var d=b.item.search(),e=b.item.search_column(),f=$v("apexir_REPORT_ID"),g;if(a="SEARCH")c?b.get.addParam("p_widget_num_return",c):$x("apexir_NUM_ROWS")&&b.get.addParam("p_widget_num_return",$v("apexir_NUM_ROWS"));apex.item(d).isEmpty()?(b.get.AddArrayItems2($x_FormItems("apexir_TOOLBAR"),1),b.pull(f)):((a="SEARCH")?(b.get.AddArrayItems2($x_FormItems("apexir_TOOLBAR"),1),a="QUICK_FILTER"):(g=[this.current_col_id,"=",$v(d)],a="FILTER",b.get.AddArray(g,1)),b.action(a,"ADD")),$s(d,"")},this.valid_action=function(a){a=="true"?b.pull():$s("apexir_DIALOG_MESSAGE",a)},this.action=function(a,c,d,e,f,g,h,i,j,k){b.l_Action=a,b._Get("ACTION",a,c,d,e,f,g,h,i,j,k)},this._Get=function(a,c,d,e,f,g,h,i,j,k,l){if(b.ajax_busy)return;b.ajax_busy=!0;if(a&&apex.jQuery.inArray(a,["ACTION","PULL"])!==-1&&!b.supress_update&&apex.event.trigger("#apexir_WORKSHEET","apexbeforerefresh",b.report_id)){b.ajax_busy=!1;return}b._Loading(),b.get.addParam("p_widget_name","worksheet"),a?b.get.addParam("p_widget_mod",a):null,c?b.get.addParam("p_widget_action",c):null,d?b.get.addParam("p_widget_action_mod",d):null,b.get.addParam("x01",$v("apexir_WORKSHEET_ID")),b.report_id?b.get.addParam("x02",b.report_id):"0",e?b.get.addParam("x03",e):null,f?b.get.addParam("x04",f):null,g?b.get.addParam("x05",g):null,h?b.get.addParam("x06",h):null,i?b.get.addParam("x07",i):null,j?b.get.addParam("x08",j):null,k?b.get.addParam("x09",k):null,l?b.get.addParam("x10",l):null;if(!!b.external_items){var m=b.external_items.split(",");b.get.AddPageItems(m)}b.get.GetAsync(b._Return)},this._Loading=function(){$x_Hide("apexir_rollover"),b._BusyGraphic(1);return},this._Finished_Loading=function(){b._BusyGraphic(4);if(ie){b.lCSS||(b.lCSS=document.createStyleSheet()),startTag='<style id="apexir_WORKSHEET_CSS" type="text/css">',endTag="</style>";var a=p.responseText.indexOf(startTag),c=p.responseText.substring(a+startTag.length),d=c.indexOf(endTag);c=c.substring(0,d),b.lCSS.cssText=c}document.onclick=null,b.init(),gReport.websheet&&gReport.websheet.init(),!b.l_LastFunction||(b.l_LastFunction(),b.l_LastFunction=!1),b.ajax_busy=!1;return},this._BusyGraphic=function(a){a==1?$x_Show("apexir_LOADER"):$x_Hide("apexir_LOADER");return},this._Return=function(){var a;if(p.readyState!=1&&p.readyState!=2&&p.readyState!=3){if(p.readyState!=4)return!1;$x_Hide("searchdrop").innerHTML="";if(b.l_Action=="CONTROL"){if(b.current_control=="COL_LOV"){var c=new $d_LOV_from_JSON;c.l_Type="SELECT",c.create(gReport.controls.lov_dom.parentNode,p.responseText),$s(c.l_Dom,gReport.controls.value),c.l_Dom.focus(),c.l_Dom.id="killme",apex.jQuery(c.l_Dom).one("blur change",function(a){cellsave(a,this)})}else if(b.current_control=="RADIO_LOV"){var c=new $d_LOV_from_JSON;c.l_Type="RADIO",c.create(gReport.controls.lov_dom,p.responseText,null,null,gReport.controls.value,!0),lDialog.dialog({bgiframe:!0,draggable:!1,show:"drop",hide:"drop",modal:!0,position:[gReport.websheet.currentForm.offsetLeft,gReport.websheet.currentForm.offsetTop+gReport.websheet.currentForm.offsetHeight],close:function(){cellsave(null,gReport.websheet.currentForm)}}),apex.jQuery(":radio",gReport.controls.lov_dom).change(function(){$s(gReport.websheet.currentForm,this.id),apex.jQuery(gReport.controls.lov_dom).dialog("close")})}else if(b.current_control=="SORT_WIDGET"){var d=$u_eval("("+p.responseText+")");b.dialog.id=d.dialog.id;var e=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Show_Hide([e,"apexir_sortup","apexir_sortdown","apexir_search","apexir_removefilter","apexir_hide","apexir_break","apexir_info","apexir_computation"],d.dialog.hide),$x_Hide(d.dialog.hide);if(d.dialog.uv){var f=d.dialog.row.length;for(var g=0;g<f;g++)if(d.dialog.row[g].R!=null){if(d.dialog.row[g].D!=null)var h=d.dialog.row[g].D;else var h=d.dialog.row[g].R;var i=$dom_AddTag("apexir_rollover_content","a",h);i.apexir_RETURN_VALUE=d.dialog.row[g].R,i.href="javascript:void(false);",i.onclick=function(){var a=[b.current_col_id,"=",this.apexir_RETURN_VALUE,"",""];b.get.AddArray(a,1),b._Get("ACTION","COL_FILTER")}}f>10?$x_Style("apexir_rollover_content","height","210px"):$x_Style("apexir_rollover_content","height",""),$x_Show("apexir_rollover_content"),$s("apexir_search","")}else $x_Hide("apexir_rollover_content");var j=$x(b.current_col_dom);$x_Show("apexir_rollover"),$x_Style("apexir_rollover","left",findPosX(j.parentNode)+"px"),$x_Style("apexir_rollover","top",findPosY(j)+j.offsetHeight+5+"px"),$x_Class(j.parentNode,"current"),b.last_col_id=j.id,document.body.onclick=b.dialog.check}else if(b.current_control=="SHOW_FILTER"||b.current_control=="SHOW_HIGHLIGHT"){var k=b.item.control_panel_drop();apex.jQuery(k).html(p.responseText),$x_Show(k),b.dialog.column_check($x("apexir_COLUMN_NAME"))}else if(b.current_control=="SHOW_SAVE_DEFAULT"){var k=b.item.control_panel_drop();$s(k,p.responseText),$x_Show(k),b.save_default_type_check()}else if(b.current_control=="NARROW"||b.current_control=="FORMAT_MASK_LOV"){var c=new $d_LOV_from_JSON;c.l_Type="a",c.create(l,p.responseText),c.l_Dom.id="apexir_col_values_drop",$x_Style(c.l_Dom,"height","200px"),$x_Style(c.l_Dom,"display","block"),$x("apexir_col_values_drop_space")||(lThis=$dom_AddTag($x(b.temp_return_element).parentNode,"BR"),lThis.id="apexir_col_values_drop_space"),$x(b.temp_return_element).parentNode.appendChild(c.l_Dom);for(var g=0,f=c.l_NewEls.length;g<f;g++)i=c.l_NewEls[g],i.href="javascript:void(false)",b.current_control=="NARROW"?i.onclick=function(){var a=$x("apexir_COLUMN_NAME"),c=$x("apexir_"+a.options[a.selectedIndex].className+"_OPT"),d=$v(c);d=="in"||d=="not in"?(d=$v(b.temp_return_element),$s(b.temp_return_element,apex.item(b.temp_return_element).isEmpty()?this.id:d+","+this.id)):($s(b.temp_return_element,this.id),$x_Remove("apexir_col_values_drop"),apex.jQuery("#apexir_EXPR").focus())}:i.onclick=function(){$s(b.temp_return_element,this.id),$x_Remove("apexir_col_values_drop")};b.supress_update=!1,b.l_Action=!1,apex.jQuery("#apexir_col_values_drop").on("keydown","a",function(a){var b=apex.jQuery("#apexir_col_values_drop a"),c=b.index(apex.jQuery(a.target)),d=b.length-1;b.attr("tabindex",-1);switch(a.which){case 40:c<d&&b.eq(c+1).focus(),a.preventDefault();break;case 38:c>0&&b.eq(c-1).focus(),a.preventDefault();break;case 9:$x_Remove("apexir_col_values_drop"),apex.jQuery("#apexir_btn_CANCEL").focus(),a.preventDefault();break;case 27:$x_Remove("apexir_col_values_drop"),apex.jQuery("#apexir_EXPR_ICON_LINK").focus(),a.stopImmediatePropagation();break;default:null}}),a=apex.jQuery("#apexir_col_values_drop a:first"),document.body.onclick=b.dialog.check2}else if(b.current_control=="INFO"){var e=$x("apexir_rollover").getElementsByTagName("TABLE")[0];$x_Hide(e),$x_Show("apexir_rollover_content"),$s("apexir_rollover_content",p.responseText),$x_Style("apexir_rollover_content","height","");var j=$x(b.current_col_dom);$x_Show("apexir_rollover"),$x_Style("apexir_rollover","left",findPosX(j.parentNode)+"px"),$x_Style("apexir_rollover_content","top",findPosY(j)+j.offsetHeight+5+"px"),$x_Class(j.parentNode,"current"),b.last_col_id=j.id,document.body.onclick=b.dialog.check}else if(b.current_control=="SEARCH_COLUMN"){var l=$x("apexir_SEARCHDROP");$s(l,"");var c=new $d_LOV_from_JSON;c.l_Type="a",c.create(l,p.responseText),c.l_Dom.id="apexir_columnsearch";var m=b.item.search_column();for(var g=0,f=c.l_NewEls.length;g<f;g++)c.l_NewEls[g].href="javascript:void(0)",c.l_NewEls[g].onclick=function(){this.id!=0?($s("apexir_SEARCH_COLUMN_DROP",this.innerHTML+""),$s(m,this.id)):($s("apexir_SEARCH_COLUMN_DROP",""),$s(m,"")),$x_Hide(l),apex.jQuery("#apexir_SEARCH").focus(),apex.jQuery(document).unbind("keydown.menu_keys_colsearch")};$x_Show(l),document.body.onclick=b.dialog.check,b.key.$gAnchorList=apex.jQuery("#apexir_SEARCHDROP").children().children().filter("a"),apex.jQuery(document).bind("keydown.menu_keys_colsearch",function(a){var c=[40,38,27,13];apex.jQuery("#apexir_SEARCHDROP:visible")[0]&&apex.jQuery.inArray(a.which,c)!==-1&&b.key.action(a,apex.jQuery("#apexir_SEARCHDROPROOT"),"menu_keys_colsearch")})}else if(b.current_control=="SHOW_DETAIL")$x_Hide(b.item.worksheet_report()),$s("apexir_DATA_PANEL",""),$s("apexir_CONTROL_PANEL_DROP",""),$s(b.item.worksheet_detail(),p.responseText),$x_Show(b.item.worksheet_detail());else{var k=b.item.control_panel_drop();apex.jQuery(k).html(p.responseText),b.current_control=="SHOW_CHART"&&b.chart.control(),b.controls.set&&($s("apexir_COLUMN_NAME",b.last_col_id),$s("apexir_EXPR",$v("apexir_SEARCH")),b.controls.set=!1,$s("apexir_SEARCH",""));if(b.current_control=="SHOW_COLUMN"){window.g_Shuttlep_v01=null;if(!n)var n=[];n[2]=$x("apexir_SHUTTLE_LEFT"),n[1]=$x("apexir_SHUTTLE_RIGHT"),window.g_Shuttlep_v01=new dhtml_ShuttleObject(n[2],n[1])}$x_Show(k)}a===undefined&&(a=apex.jQuery(":input:visible",apex.jQuery("#apexir_CONTROL_PANEL_DROP"))),a.length>0&&a[0].focus()}else if(b.supress_update){if(b.l_Action=="SAVE_NOTIFY"||b.l_Action=="SAVE_COMPUTATION"||b.l_Action=="FLASHBACK_SET"||b.l_Action=="SAVE_HIGHLIGHT"||b.l_Action=="FILTER"||b.l_Action=="GROUP_BY_SAVE"||b.l_Action=="SAVE_CHART")b.l_LastFunction=function(){b.valid_action(p.responseText)};b.ajax_busy=!1,b.supress_update=!1,b.l_Action=!1}else{b.ajax_busy=!1,$x_Hide("apexir_rollover"),i=$x("apexir_WORKSHEET"),i.id="apexir_WORKSHEET_old";var o=$x("apexir_TOOLBAR_OPEN");o.id="apexir_TOOLBAR_OPEN_old";var q=$x("apexir_ACTIONSMENU"),r=$x("apexir_FORMAT_MENU"),s=$x("apexir_ROWS_PER_PAGE_MENU");q.id="apexir_ACTIONSMENU_old",r.id="apexir_FORMAT_MENU_old",s.id="apexir_ROWS_PER_PAGE_MENU_old";var t=$x("apexir_WEBSHEETMENU");if(t){var u=$x("apexir_ROWS"),v=$x("apexir_COLUMN");t.id="apexir_WEBSHEETMENU_old",u.id="apexir_ROWS_old",v.id="apexir_COLUMN_old"}lThis=$u_js_temp_drop(),apex.jQuery(lThis).html(p.responseText),i.parentNode.replaceChild($x("apexir_WORKSHEET"),i),$x("apexir_TOOLBAR_OPEN")?(apex.jQuery("#apexir_ACTIONSMENU_old,#apexir_FORMAT_MENU_old,#apexir_ROWS_PER_PAGE_MENU_old").remove(),t&&apex.jQuery("#apexir_WEBSHEETMENU_old,#apexir_ROWS_old,#apexir_COLUMN_old").remove(),o.parentNode.replaceChild($x("apexir_TOOLBAR_OPEN"),o)):(q.id="apexir_ACTIONSMENU",r.id="apexir_FORMAT_MENU",s.id="apexir_ROWS_PER_PAGE_MENU",t&&(t.id="apexir_WEBSHEETMENU",u.id="apexir_ROWS",v.id="apexir_COLUMN")),$d_ClearAndHide("apexir_DETAIL"),$s("apexir_CURRENT_SEARCH_COLUMN",""),$s("apexir_SEARCH_COLUMN_DROP",""),$x_Show("apexir_REPORT"),$u_js_temp_clear(),apex.jQuery("#apexir_WORKSHEET").trigger("apexafterrefresh",b.report_id)}b._Finished_Loading()}},this.dialog2=this.controls.get;return}};